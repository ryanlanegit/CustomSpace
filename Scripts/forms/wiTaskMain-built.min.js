define("text",["module"],function(e){"use strict";var n,t,i,o,r,a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],s=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,l=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,d="undefined"!=typeof location&&location.href,c=d&&location.protocol&&location.protocol.replace(/\:/,""),u=d&&location.hostname,p=d&&(location.port||void 0),f={},m=e.config&&e.config()||{};return n={version:"2.0.10",strip:function(e){if(e){e=e.replace(s,"");var n=e.match(l);n&&(e=n[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:m.createXhr||function(){var e,n,t;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(n=0;n<3;n+=1){t=a[n];try{e=new ActiveXObject(t)}catch(e){}if(e){a=[t];break}}return e},parseName:function(e){var n,t,i,o=!1,r=e.indexOf("."),a=0===e.indexOf("./")||0===e.indexOf("../");return-1!==r&&(!a||r>1)?(n=e.substring(0,r),t=e.substring(r+1,e.length)):n=e,i=t||n,r=i.indexOf("!"),-1!==r&&(o="strip"===i.substring(r+1),i=i.substring(0,r),t?t=i:n=i),{moduleName:n,ext:t,strip:o}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,i,o){var r,a,s,l=n.xdRegExp.exec(e);return!l||(r=l[2],a=l[3],a=a.split(":"),s=a[1],a=a[0],!(r&&r!==t||a&&a.toLowerCase()!==i.toLowerCase()||(s||a)&&s!==o))},finishLoad:function(e,t,i,o){i=t?n.strip(i):i,m.isBuild&&(f[e]=i),o(i)},load:function(e,t,i,o){if(o.isBuild&&!o.inlineText)return void i();m.isBuild=o.isBuild;var r=n.parseName(e),a=r.moduleName+(r.ext?"."+r.ext:""),s=t.toUrl(a),l=m.useXhr||n.useXhr;if(0===s.indexOf("empty:"))return void i();!d||l(s,c,u,p)?n.get(s,function(t){n.finishLoad(e,r.strip,t,i)},function(e){i.error&&i.error(e)}):t([a],function(e){n.finishLoad(r.moduleName+"."+r.ext,r.strip,e,i)})},write:function(e,t,i,o){if(f.hasOwnProperty(t)){var r=n.jsEscape(f[t]);i.asModule(e+"!"+t,"define(function () { return '"+r+"';});\n")}},writeFile:function(e,t,i,o,r){var a=n.parseName(t),s=a.ext?"."+a.ext:"",l=a.moduleName+s,d=i.toUrl(a.moduleName+s)+".js";n.load(l,i,function(t){var i=function(e){return o(d,e)};i.asModule=function(e,n){return o.asModule(e,d,n)},n.write(e,l,i,r)},r)}},"node"===m.env||!m.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(t=require.nodeRequire("fs"),n.get=function(e,n,i){try{var o=t.readFileSync(e,"utf8");0===o.indexOf("\ufeff")&&(o=o.substring(1)),n(o)}catch(e){i(e)}}):"xhr"===m.env||!m.env&&n.createXhr()?n.get=function(e,t,i,o){var r,a=n.createXhr();if(a.open("GET",e,!0),o)for(r in o)o.hasOwnProperty(r)&&a.setRequestHeader(r.toLowerCase(),o[r]);m.onXhr&&m.onXhr(a,e),a.onreadystatechange=function(n){var o,r;4===a.readyState&&(o=a.status,o>399&&o<600?(r=new Error(e+" HTTP status: "+o),r.xhr=a,i(r)):t(a.responseText),m.onXhrComplete&&m.onXhrComplete(a,e))},a.send(null)}:"rhino"===m.env||!m.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?n.get=function(e,n){var t,i,o=new java.io.File(e),r=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),"utf-8")),s="";try{for(t=new java.lang.StringBuffer,i=a.readLine(),i&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),null!==i&&t.append(i);null!==(i=a.readLine());)t.append(r),t.append(i);s=String(t.toString())}finally{a.close()}n(s)}:("xpconnect"===m.env||!m.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(i=Components.classes,o=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),r="@mozilla.org/windows-registry-key;1"in i,n.get=function(e,n){var t,a,s,l={};r&&(e=e.replace(/\//g,"\\")),s=new FileUtils.File(e);try{t=i["@mozilla.org/network/file-input-stream;1"].createInstance(o.nsIFileInputStream),t.init(s,1,0,!1),a=i["@mozilla.org/intl/converter-input-stream;1"].createInstance(o.nsIConverterInputStream),a.init(t,"utf-8",t.available(),o.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),a.readString(t.available(),l),a.close(),t.close(),n(l.value)}catch(e){throw new Error((s&&s.path||"")+": "+e)}}),n}),define("text!forms/tasks/anchor/view.html",[],function(){return'<li class="link" data-bind="click: <%= Target %>"><%= Label %></li>'}),define("text!CustomSpace/Scripts/forms/tasks/resolveIncident/view.html",[],function(){return'<div id="ResolveIncidentWindow" class="cireson-window defined-form hide" style="padding-bottom: 0px;">\r\n    <div class="cireson-window--wrapper">\r\n        <div class="cireson-window--body">\r\n            <div id="resolutionPicker" data-bind="" />\r\n            <div id="resolutionDescription" data-bind="" />\r\n            <div id="resolutionAssignToMe" data-bind="visible: showResolutionAssignToMe" />\r\n        </div>\r\n        <div class="window-buttons cireson-window--footer" style="line-height: 65px; height: 65px">\r\n            <div id="resolveIncidentErrorWin" class="error"></div>\r\n            <button data-role="button"\r\n                    class="btn btn-primary"\r\n                    data-bind="enabled: okEnabled, events: { click: okClick }">\r\n                <%= localization.OK %>\r\n            </button>\r\n            <button data-role="button"\r\n                    class="btn btn-default"\r\n                    data-bind="events: { click: cancelClick }">\r\n                <%= localization.Cancel %>\r\n            </button>\r\n        </div>\r\n    </div>\r\n</div>'}),define("text!forms/fields/enum/view.html",[],function(){return'<div class="form-group">\r\n    <label class="control-label" for="<%= PropertyName %>" data-localize="<%= PropertyDisplayName %>">\r\n        <span><% if ( Required ){ %> <%= \'(\' + localization.Required + \')\' %><% } %></span>\r\n    </label>\r\n\r\n    <div class="form-control form-control-picker input-sm"\r\n         data-url="/api/V3/Enum/GetList"\r\n         data-combourl="/api/V3/Enum/GetFlatList/"\r\n         data-showpath="<%= ShowPath %>"\r\n         data-mustselectleafnode="<%= LeafNodeOnly %>"\r\n         data-bind="ciresonDropDownTree: \'<%= EnumId %>\', value: <%= PropertyName %>"\r\n         data-disabled="<%= Disabled %>"\r\n         data-role="<%= PropertyName %>"\r\n         data-filter="<%= FilterIds%>"\r\n        <% if ( Required ){ %>\r\n        required\r\n        <% } %>\r\n        >\r\n\r\n    </div>\r\n\r\n</div>'}),define("forms/fields/enum/controller",["require","text!forms/fields/enum/view.html"],function(e){var n=e("text!forms/fields/enum/view.html");return{template:n,build:function(e,t,i){var o=_.template(n),r={EnumId:"",Required:t.Required,Disabled:t.disabled,LeafNodeOnly:!1,ShowPath:!1,FilterIds:""};$.extend(!0,r,t),i(o(r))}}}),define("text!CustomSpace/Scripts/forms/fields/longstring/view.html",[],function(){return'<div class="form-group <%= visible %>" style="">\r\n\r\n    <label class="control-label" for="<%= PropertyName %>">\r\n        <span><%= PropertyDisplayName %> <% if (Required) { %> (<%= localization.Required %>)<% } %></span>\r\n        <span style="font-weight: normal; float:right; color: #6E8B9B;">\r\n            <span name="<%= PropertyName %>CharactersRemaining" data-bind="html: CharactersRemaining"></span>\r\n            <span>characters remaining</span>\r\n        </span>\r\n    </label>\r\n    <textarea name="<%= PropertyName %>"\r\n              class="k-textbox form-control input-sm"\r\n              rows="<%= Rows %>"\r\n              placeholder="<%= PlaceHolder %>"\r\n              data-bind="value: <%= PropertyName %>, events : { <% if ( LimitLength ){ %>blur: CheckLength<% } %>, keyup: TextCounter }"\r\n              data-value-update="keyup"\r\n            <% if (LimitLength) { %>\r\n              maxlength="<%= MaxLength %>"\r\n            <% } %>\r\n            <% if (Disabled) { %>\r\n              disabled\r\n            <% } %>\r\n            <% if (Required) { %>\r\n              required\r\n            <% } %>\r\n    >\r\n    </textarea>\r\n    <% if (LimitLength) { %>\r\n    <p class="help-block validation-summary-errors" style="display: none;"><%= localization.MaxLengthError.replace("{0}", MaxLength) %></p>\r\n    <% } %>\r\n</div>\r\n<script>\r\n    $("textarea[name=\'ResolutionDescription\']").removeClass("form-control");\r\n<\/script>'}),define("CustomSpace/Scripts/forms/fields/longstring/controller",["text!CustomSpace/Scripts/forms/fields/longstring/view.html"],function(e){"use strict";return{template:e,build:function(n,t,i){function o(e){var n={CharactersRemaining:e.MaxLength,CheckLength:function(e){setTimeout(function(){var n=$(e.currentTarget),t=n.next(),i=n.attr("maxlength");n.val().length>i?(n.attr("data-invalid",""),t.show()):(t.hide(),n.removeAttr("data-invalid"),n.data("prevent",!1))},100)},TextCounter:function(){this.set("CharactersRemaining",this.MaxLength-this.ResolutionDescription.length)}};return kendo.observable($.extend(!0,n,e))}_.isUndefined(n[t.PropertyName])&&(n[t.PropertyName]=[]);var r={fieldEle:function(e,n,o){$.extend(!0,e,t);var r=_.template(o),a=new kendo.View(r(e),{wrap:!1,model:n});return"function"==typeof i&&i(a.render()),a}};return function(){var i={Required:t.Required,Disabled:t.disabled,MinLength:t.MinLength,MaxLength:t.MaxLength,LimitLength:!_.isUndefined(t.MinLength)||!_.isUndefined(t.MaxLength),Rows:t.Rows||5,visible:_.isUndefined(t.IsVisible)||!1!==t.IsVisible?"":"hidden"},a=o(i),s=r.fieldEle(i,a,e);return n[t.PropertyName]=a,s}()}}}),define("text!forms/fields/boolean/view.html",[],function(){return'<div class="form-group <%= visible %>">\r\n    <% if ( !Inline ){ %>\r\n    <label class="control-label" data-localize="<%= PropertyDisplayName %>"><span><% if ( Required ){ %> <%= \'(\' + localization.Required + \')\' %><% } %></span></label>\r\n    <% } %>\r\n\r\n    <div class="checkbox <% if ( Inline ){ %> checkbox-inline <% } else { %> checkbox-block <% } %>">\r\n        <input type="checkbox"\r\n               name="<%= PropertyName %>"\r\n               id="<%= PropertyName %>"\r\n               data-bind="checked: <%= PropertyName %>"<% if ( Disabled ){ %>\r\n        disabled\r\n        <% } %>\r\n\r\n        />\r\n\r\n\r\n        <label class="control-label" for="<%= PropertyName %>">\r\n            <% if ( Inline ){ %>\r\n            <span data-localize="<%= PropertyDisplayName %>"></span>\r\n            <% } %>\r\n        </label>\r\n\r\n    </div>\r\n</div>'}),define("forms/fields/boolean/controller",["require","text!forms/fields/boolean/view.html"],function(e){var n=e("text!forms/fields/boolean/view.html");return{template:n,build:function(e,t,i){var o=_.template(n),r={Disabled:t.disabled,Required:t.Required,Inline:t.Inline||!1,visible:_.isUndefined(t.IsVisible)||0!=t.IsVisible?"":"hidden"};$.extend(!0,r,t),i(o(r))}}}),define("CustomSpace/Scripts/forms/tasks/resolveIncident/controller",["text!forms/tasks/anchor/view.html","text!CustomSpace/Scripts/forms/tasks/resolveIncident/view.html","forms/fields/enum/controller","CustomSpace/Scripts/forms/fields/longstring/controller","forms/fields/boolean/controller"],function(e,n,t,i,o){"use strict";var r={Task:"resolveIncident",Type:"Incident",Label:"Resolve Incident",Access:1===session.user.Analyst,Configs:{ResolutionCategory:{Id:"c5f6ada9-a0df-01d6-7087-6b8500ca6c2b",Name:"Fixed by analyst"},description:{MinLength:4,MaxLength:4e3,Rows:4}}},a="2b8830b6-59f0-f574-9c2a-f4b4682f1681";return{template:n,task:r,build:function(r,s,l){function d(e,n,i){t.build(i,n,function(n){e.html(n),app.controls.apply(e,{localize:!0,vm:i,bind:!0})})}function c(e,n,t){return i.build(t,n,function(n){e.html(n)})}function u(e,n,t){o.build(t,n,function(n){e.html(n),app.controls.apply(e,{localize:!0,vm:t,bind:!0})})}function p(e){var n=$(".popupNotification:first"),t=n.getKendoNotification("kendoNotification");_.isUndefined(t)?t=n.kendoNotification({templates:[{type:"resolveIncidentNotification",template:'<div class="success k-ext-dialog-content"><div class="k-ext-dialog-icon fa fa-check"></div><div class="k-ext-dialog-message">#= message #</div></div>'}]}).data("kendoNotification"):t.hide(),t.show({message:app.custom.utils.stringFormat(e,r.viewModel.Id)},"resolveIncidentNotification")}function f(e,n){var t={PropertyName:"ResolutionCategory",PropertyDisplayName:"ResolutionCategory",Required:!0,EnumId:e.resolutionCategoryEnumId},i={PropertyName:"ResolutionDescription",PropertyDisplayName:"Resolution Notes",PlaceHolder:"Resolution Notes...",Required:!1,MaxLength:s.Configs.description.MaxLength,CharactersRemaining:s.Configs.description.MaxLength,Rows:s.Configs.description.Rows},o={PropertyName:"ResolutionAssignToMe",PropertyDisplayName:"Assign To Me",Inline:!0,Disabled:!1,Required:!1,Checked:!0};d(n.find("#resolutionPicker"),t,e),c(n.find("#resolutionDescription"),i,e),u(n.find("#resolutionAssignToMe"),o,e)}function m(e){var n=app.controls.getWorkItemLogType(r.viewModel),t=$('input[name="ResolvedDate"]');switch(r.viewModel.set("ResolutionDescription",e.ResolutionDescription.ResolutionDescription),r.viewModel.set("ResolutionCategory",{Id:e.ResolutionCategory.Id}),r.viewModel.set("ResolvedDate",(new Date).toISOString()),r.viewModel.set("RelatesToTroubleTicket",{ClassTypeId:"eca3c52a-f273-5cdc-f165-3eb95a2b26cf",BaseId:session.user.Id,DisplayName:session.user.Name}),n&&r.viewModel[n].unshift(new app.dataModels[n].recordResolved(e.ResolutionDescription.ResolutionDescription)),t.attr("data-control")){case"datePicker":t.val(kendo.toString(new Date,"d"));break;case"dateTimePicker":t.val(kendo.toString(new Date,"g"))}r.viewModel.set("Status",{Id:a,Name:"Resolved"}),e.showResolutionAssignToMe&&e.ResolutionAssignToMe&&(r.viewModel.AssignedWorkItem.set("BaseId",session.user.Id),r.viewModel.AssignedWorkItem.set("DisplayName",session.user.Name)),p("{0} has been resolved.<br/>Click Save or Apply to complete the process.")}function v(e,n){""===e.ResolutionCategory.Id||n.find('div[data-role="ResolutionCategory"] > span > span').hasClass("input-error")?e.set("okEnabled",!1):e.set("okEnabled",!0)}function g(e,n){n.find('textarea[name="ResolutionDescription"]').focus(),v(e,n)}function b(e,n){function t(){v(e,n)}var i=n.find('div[data-role="ResolutionCategory"]').data("kendoExtDropDownTreeViewV3");i._dropdown.input.keyup(t),i.bind("change",t),i._dropdown.bind("change",t),i._treeview.bind("change",t)}function h(){return r.viewModel.AssignedWorkItem.get("BaseId")===session.user.Id}function w(e){return new kendo.observable({resolveIncident:function(){var n,t,i;r.viewModel.get("Status").Id===a?(p("{0} is already resolved."),$('a[data-toggle][data-cid="Resolution"]').click()):(n=e.element,t=n.kendoCiresonWindow({title:s.Label,width:500,minWidth:250,height:400,close:function(){},activate:function(){g(i,n)}}).data("kendoWindow"),i=kendo.observable({ResolutionCategory:s.Configs.ResolutionCategory,resolutionCategoryEnumId:"72674491-02cb-1d90-a48f-1b269eb83602",showResolutionAssignToMe:!h(),ResolutionAssignToMe:!0,okEnabled:!1,okClick:function(){m(i),t.close()},cancelClick:function(){t.close()}}),kendo.bind(n,i),f(i,n),b(i,n),!_.isUndefined(app.storage.custom)&&app.storage.custom.get("DEBUG_ENABLED")&&console.log("resolveIncidentTask:resolveIncident",{modalWindowEle:n,modalWindowControl:t,modalWindowViewModel:i}),n.removeClass("hide"),n.show(),t.wrapper.css("padding-bottom","65px"),t.open())}})}!_.isUndefined(app.storage.custom)&&app.storage.custom.get("DEBUG_ENABLED")&&console.log("resolveIncidentTask:build");var y={windowEle:function(e){var n=_.template(e),t=new kendo.View(n(),{wrap:!1});return"function"==typeof l&&l(t.render()),t},taskListItem:function(e,n,t){$.extend(!0,e,s);var i=_.template(t),o=new kendo.View(i(e),{wrap:!1,model:n});return"function"==typeof l&&l(o.render()),o}};!function(){var t=y.windowEle(n),i=w(t),o={Target:s.Task};y.taskListItem(o,i,e)}()}}}),define("CustomSpace/Scripts/forms/wiTaskBuilder",["CustomSpace/Scripts/forms/tasks/resolveIncident/controller"],function(){"use strict";var e=arguments;return{build:function(n,t){var i=$(".taskmenu"),o=function(e){i.append(e)};!_.isUndefined(app.storage.custom)&&app.storage.custom.get("DEBUG_ENABLED")&&console.log("wiTaskBuilder:build",{performance:performance.now(),vm:n,taskModules:e}),_.each(e,function(e){e.task.Access&&-1!==e.task.Type.indexOf(n.type)&&e.build(n,e.task,function(e){o(e)})}),"function"==typeof t&&t(i)}}}),require.config({waitSeconds:0,urlArgs:"v="+("undefined"!=typeof session&&void 0!==session.staticFileVersion?session.staticFileVersion:894),baseUrl:"/Scripts/",paths:{text:"require/text",CustomSpace:"../CustomSpace"}}),require(["CustomSpace/Scripts/forms/wiTaskBuilder"],function(e){"use strict";function n(){!_.isUndefined(app.storage.custom)&&app.storage.custom.get("DEBUG_ENABLED")&&console.log("wiTaskMain:initTasks",performance.now());var n=!1;pageForm.newWI||"c7b65747-f99e-c108-1e17-3c1062138fc4"!==pageForm.viewModel.Status.Id&&"f228d50b-2b5a-010f-b1a4-5c7d95703a9b"!==pageForm.viewModel.Status.Id&&"bd0ae7c4-3315-2eb3-7933-82dfc482dbaf"!==pageForm.viewModel.Status.Id&&"25eac210-e091-8ae8-a713-fea2472f32ff"!==pageForm.viewModel.Status.Id&&"221155fc-ad9f-1e40-c50e-9028ee303137"!==pageForm.viewModel.Status.Id||(n=!0),n||e.build(pageForm,function(e){app.custom.utils.sortList(e),app.events.publish("wiTasksReady")})}!_.isUndefined(app.storage.custom)&&app.storage.custom.get("DEBUG_ENABLED")&&console.log("wiTaskMain",performance.now()),app.events.subscribe("boundReadyReady",function e(){!_.isUndefined(app.storage.custom)&&app.storage.custom.get("DEBUG_ENABLED")&&console.log("wiTaskMain:boundReady",performance.now()),pageForm.boundReady(function(){n(),app.events.unsubscribe("boundReadyReady",e)})})}),define("CustomSpace/Scripts/forms/wiTaskMain",function(){});
//# sourceMappingURL=/CustomSpace/Scripts/forms/wiTaskMain-built.min.js.map